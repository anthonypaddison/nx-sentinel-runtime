# 2026-02-16

## What changed
- Renamed `family-board` dashboard/card/assets to `nx-displaygrid` and updated references in HA config/docs.
- Reworked `config/packages/common/home_infra.yaml` sensor definitions to valid HA package schema and renamed it operationally to `nx-sentinel-watchtower` naming.
- Added compatibility fallback in frontend persistence WS calls (`nx_displaygrid/*` then legacy `family_board/*`).
- Added/expanded Node tests covering parser, service, discovery, and helper modules.
- Updated `_mergeConfig` in persistence to use explicit key-presence checks so empty arrays are persisted for `people`, `calendars`, `todos`, and `home_controls`.
- Added `tests/persistence-merge.test.mjs` to verify empty-array override behaviour and missing-key fallback behaviour.
- Reworked `fb-setup-view` into a first-run wizard with four explicit steps: People, Calendars, Integrations guidance, and Review/Finish.
- Added onboarding lifecycle flags in shared config (`onboardingComplete`, `schemaVersion: 1`) and card gating logic so setup reappears when onboarding is incomplete or schema mismatches.
- Added integration guidance text and detected entity pickers (`calendar.*`, `todo.*`) without auto-applying suggested defaults until user confirms via Save/Continue.

## Why
- Reduce regression risk for your primary family command center and align naming with NX conventions.
- Prevent deleted source lists from reappearing when stored config contains explicit empty arrays.
- Ensure first-run setup survives refresh and guides users through required person setup before normal dashboard use.

## How to verify
1. Run `node --test tests/*.test.mjs`.
2. In Home Assistant, run **Check configuration**.
3. Confirm dashboard loads at `nx-displaygrid` and resource URL `/local/nx-displaygrid/nx-displaygrid.js`.
4. Confirm infra sensors/entities initialize without invalid config errors.
5. In **Manage sources**, remove all calendars and save; refresh Lovelace and confirm calendars remain empty.
6. Open card in a fresh profile/config; verify wizard shows four steps, allows skipping Integrations, and persists progress after each Save/Continue.
7. Finish wizard, refresh browser, and confirm setup no longer shows while `onboardingComplete: true` and `schemaVersion: 1` are present.
